<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <parameter key="solr.class">FS\SolrBundle\SolrFacade</parameter>
        <parameter key="solr.query.facade.class">FS\SolrBundle\SolrQueryFacade</parameter>
        <parameter key="solr.command.factory.class">FS\SolrBundle\Doctrine\Mapper\Command\CommandFactory</parameter>
        <parameter key="solr.annotation.reader.class">FS\SolrBundle\Doctrine\Annotation\AnnotationReader</parameter>
        <parameter key="solr.index.listener.class">FS\SolrBundle\Doctrine\Listener\IndexListener</parameter>
        <parameter key="solr.command.fresh.class">FS\SolrBundle\Doctrine\Mapper\Command\CreateFreshDocumentCommand</parameter>
    </parameters>

    <services>
		<service id="solr" class="%solr.class%" />
        
        <service id="solr.query" class="%solr.query.facade.class%">
            <argument type="service" id="doctrine" />
            <argument type="service" id="solr.command.factory" />
        </service>

    	<service id="solr.command.factory" class="%solr.command.factory.class%" public="false" />
    	
    	<service id="solr.annotation.reader" class="%solr.annotation.reader.class%" />
    	
    	<service id="solr.index.listener" class="%solr.index.listener.class%">
    		<argument type="service" id="solr" />
    		<tag name="doctrine.event_listener" event="postPersist" />
    	</service>
    	
    	<service id="solr.command.fresh" class="%solr.command.fresh.class%">
    		<argument type="service" id="solr.annotation.reader" />
    		<tag name="solr.document.command" action="fresh" />
    	</service>
    </services>
</container>
